<!DOCTYPE html>
<html lang="ko">
<head>
  <meta charset="UTF-8">
  <title>í˜„ì¥ê´€ë¦¬ ì§€ë„</title>
  <link rel="stylesheet" href="/static/style.css">

  <!-- âœ… Socket.IO ë¨¼ì € -->
  <script src="https://cdn.socket.io/4.5.4/socket.io.min.js"></script>

  <!-- âœ… ë¨¼ì € script.jsë¥¼ ë¡œë“œ (initMapì„ ì •ì˜í•œ í›„) -->
  <script src="/static/script.js?v={{ range(100000)|random }}"></script>

  <!-- âœ… Kakao Maps JS SDK (ê³µì‹ ê¶Œì¥ ë°©ì‹: autoload=false) -->
  <script>
    window.addEventListener("load", () => {
      const script = document.createElement("script");
      script.src = "//dapi.kakao.com/v2/maps/sdk.js?autoload=false&appkey={{ kakao_javascript_key }}";
      script.onload = function() {
        console.log("âœ… Kakao Maps SDK ë¡œë“œ ì™„ë£Œ");
        if (typeof kakao !== "undefined" && kakao.maps && typeof initMap === "function") {
          kakao.maps.load(initMap);
        } else {
          console.error("âŒ initMap ë˜ëŠ” kakao.maps ë¡œë“œ ì‹¤íŒ¨");
        }
      };
      document.head.appendChild(script);
    });
  </script>

  <style>
    body { margin: 0; font-family: sans-serif; }
    header {
      padding: 10px; background: #333; color: white;
      display: flex; justify-content: space-between; align-items: center;
    }
    #map { width: 100%; height: calc(100vh - 60px); }
    .logout-btn { color: white; text-decoration: none; font-weight: bold; }
  </style>
</head>
<body>
  <header>
    <h2>ğŸ“ í˜„ì¥ê´€ë¦¬ ì§€ë„</h2>
    <div id="statusBoard">
      ì™„ë£Œ: <span id="doneCount">0</span> | 
      ë¶ˆê°€: <span id="failCount">0</span> | 
      ë¯¸ë°©ë¬¸: <span id="pendingCount">0</span>
    </div>
    <a href="/logout" class="logout-btn">ë¡œê·¸ì•„ì›ƒ</a>
  </header>
  <div id="map"></div>
</body>
</html>
